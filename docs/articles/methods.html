<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Methods and xspliner environment • xspliner</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script><script src="../pkgdown.js"></script><!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top navbar-mi2" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
	  <a class="navbar-mi2logo" href="http://mi2.mini.pw.edu.pl/">
        <img src="https://github.com/mi2-warsaw/MI2template/blob/master/inst/pkgdown/assets/MI2logo.jpg?raw=true" alt="MI2" height="46" title="MI2"></a>
      <a class="navbar-brand navbar-mi2" href="../index.html"></a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="navbar-mi2 nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/xspliner.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/automation.html">Automate your work</a>
    </li>
    <li>
      <a href="../articles/cases.html">Use cases</a>
    </li>
    <li>
      <a href="../articles/discrete.html">Classification and discrete predictors</a>
    </li>
    <li>
      <a href="../articles/extras.html">Extra information about the package</a>
    </li>
    <li>
      <a href="../articles/graphics.html">Graphics</a>
    </li>
    <li>
      <a href="../articles/methods.html">Methods and xspliner environment</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Methods and xspliner environment</h1>
                        <h4 class="author">Krystian Igras</h4>
            
            <h4 class="date">2019-06-20</h4>
      
      
      <div class="hidden name"><code>methods.Rmd</code></div>

    </div>

    
    
<div id="predict" class="section level1">
<h1 class="hasAnchor">
<a href="#predict" class="anchor"></a>Predict</h1>
<p>As xspliner final model is GLM, predict method is just wrapper of <code><a href="https://www.rdocumentation.org/packages/stats/topics/predict.glm">stats::predict.glm</a></code> function. Let’s see it on the below example:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(xspliner)</a>
<a class="sourceLine" id="cb1-2" data-line-number="2"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(randomForest)</a>
<a class="sourceLine" id="cb1-3" data-line-number="3"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(magrittr)</a>
<a class="sourceLine" id="cb1-4" data-line-number="4"></a>
<a class="sourceLine" id="cb1-5" data-line-number="5">rf_iris &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/randomForest/topics/randomForest">randomForest</a></span>(Petal.Width <span class="op">~</span><span class="st">  </span>Sepal.Length <span class="op">+</span><span class="st"> </span>Petal.Length <span class="op">+</span><span class="st"> </span>Species, <span class="dt">data =</span> iris)</a>
<a class="sourceLine" id="cb1-6" data-line-number="6">model_xs &lt;-<span class="st"> </span><span class="kw"><a href="../reference/xspline.html">xspline</a></span>(Petal.Width <span class="op">~</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1-7" data-line-number="7"><span class="st">  </span>Sepal.Length <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1-8" data-line-number="8"><span class="st">  </span><span class="kw">xs</span>(Petal.Length, <span class="dt">effect =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/list">list</a></span>(<span class="dt">grid.resolution =</span> <span class="dv">100</span>), <span class="dt">transition =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/list">list</a></span>(<span class="dt">bs =</span> <span class="st">"cr"</span>)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1-9" data-line-number="9"><span class="st">  </span><span class="kw">xf</span>(Species, <span class="dt">transition =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/list">list</a></span>(<span class="dt">stat =</span> <span class="st">"loglikelihood"</span>, <span class="dt">value =</span> <span class="dv">-300</span>)),</a>
<a class="sourceLine" id="cb1-10" data-line-number="10">  <span class="dt">model =</span> rf_iris)</a>
<a class="sourceLine" id="cb1-11" data-line-number="11">newdata &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/data.frame">data.frame</a></span>(</a>
<a class="sourceLine" id="cb1-12" data-line-number="12">  <span class="dt">Sepal.Length =</span> <span class="dv">10</span>, </a>
<a class="sourceLine" id="cb1-13" data-line-number="13">  <span class="dt">Petal.Length =</span> <span class="dv">2</span>, </a>
<a class="sourceLine" id="cb1-14" data-line-number="14">  <span class="dt">Species =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/factor">factor</a></span>(<span class="st">"virginica"</span>, <span class="dt">levels =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/levels">levels</a></span>(iris<span class="op">$</span>Species)))</a>
<a class="sourceLine" id="cb1-15" data-line-number="15"><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/predict">predict</a></span>(model_xs, <span class="dt">newdata =</span> newdata)</a></code></pre></div>
<pre><code>##          1 
## -0.3012747</code></pre>
</div>
<div id="print" class="section level1">
<h1 class="hasAnchor">
<a href="#print" class="anchor"></a>Print</h1>
<p>Print method works similarly to the summary. In case of passing just the model, standard <code>print.glm</code> is used.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/print">print</a></span>(model_xs)</a></code></pre></div>
<pre><code>## 
## Call:  stats::glm(formula = Petal.Width ~ Sepal.Length + xs(Petal.Length) + 
##     xf(Species), family = family, data = data)
## 
## Coefficients:
##                    (Intercept)                    Sepal.Length  
##                       -2.18088                        -0.01554  
##               xs(Petal.Length)  xf(Species)versicolorvirginica  
##                        3.24401                        -0.54145  
## 
## Degrees of Freedom: 149 Total (i.e. Null);  146 Residual
## Null Deviance:       86.57 
## Residual Deviance: 5.095     AIC: -71.68</code></pre>
<div id="predictor-based-print" class="section level2">
<h2 class="hasAnchor">
<a href="#predictor-based-print" class="anchor"></a>Predictor based print</h2>
<p>Summary method allows you to check details about transformation of specific variable.</p>
<p>Standard usage <code><a href="https://www.rdocumentation.org/packages/base/topics/print">print(xspliner_object, variable_name)</a></code></p>
<p><em>Quantitative variable</em></p>
<p>When predictor is the quantitative variable its transition is based on GAM model. For this case print uses standard <code>print.gam</code> method.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/print">print</a></span>(model_xs, <span class="st">"Petal.Length"</span>)</a></code></pre></div>
<pre><code>## 
## Family: gaussian 
## Link function: identity 
## 
## Formula:
## yhat ~ s(Petal.Length, bs = "cr")
## 
## Estimated degrees of freedom:
## 8.8  total = 9.8 
## 
## GCV score: 0.001355993</code></pre>
<p><em>Qualitative variable</em></p>
<p>In case of qualitative predictor, standard <code>print.factorMerger</code> method is used.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/print">print</a></span>(model_xs, <span class="st">"Species"</span>)</a></code></pre></div>
<pre><code>## Family: gaussian Factor Merger.
## 
## Factor levels were merged in the following order:
## 
##      groupA       groupB                     model   pvalVsFull   pvalVsPrevious
## ---  -----------  --------------------  ----------  -----------  ---------------
## 0                                        -251.5247            1                1
## 1    versicolor   virginica              -268.7814            0                0
## 2    setosa       versicolorvirginica    -352.0094            0                0</code></pre>
</div>
</div>
<div id="plot" class="section level1">
<h1 class="hasAnchor">
<a href="#plot" class="anchor"></a>Plot</h1>
<p>You can see all details in <a href="./graphics.html">graphics</a></p>
</div>
<div id="transition" class="section level1">
<h1 class="hasAnchor">
<a href="#transition" class="anchor"></a>Transition</h1>
<p>Transition method allows you to extract objects used during building transition of variables. There are three possible object types that can be extracted.</p>
<div id="extracting-effect" class="section level2">
<h2 class="hasAnchor">
<a href="#extracting-effect" class="anchor"></a>Extracting effect</h2>
<p>Each transition is built on top of the black box response data. For example the default response for quantitative variables is PDP - for qualitative ones ICE.</p>
<p>In order to extract the effect use transition method with <code>type</code> parameter equals to data</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1"><span class="kw"><a href="../reference/transition.html">transition</a></span>(model_xs, <span class="dt">predictor =</span> <span class="st">"Petal.Length"</span>, <span class="dt">type =</span> <span class="st">"data"</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb9-2" data-line-number="2"><span class="st">  </span>head</a></code></pre></div>
<pre><code>##   Petal.Length      yhat
## 1     1.000000 0.7649815
## 2     1.059596 0.7649215
## 3     1.119192 0.7649215
## 4     1.178788 0.7679251
## 5     1.238384 0.7694617
## 6     1.297980 0.7729730</code></pre>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" data-line-number="1"><span class="kw"><a href="../reference/transition.html">transition</a></span>(model_xs, <span class="dt">predictor =</span> <span class="st">"Species"</span>, <span class="dt">type =</span> <span class="st">"data"</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb11-2" data-line-number="2"><span class="st">  </span>head</a></code></pre></div>
<pre><code>##      Species      yhat yhat.id
## 1     setosa 0.2459612       1
## 2 versicolor 0.7083571       1
## 3  virginica 0.8813188       1
## 4     setosa 0.2160978       2
## 5 versicolor 0.7033705       2
## 6  virginica 0.8777869       2</code></pre>
</div>
<div id="extracting-transition-model" class="section level2">
<h2 class="hasAnchor">
<a href="#extracting-transition-model" class="anchor"></a>Extracting transition model</h2>
<p>After we built transition basing on continuity of variable specific model is created. In case of quantitative predictor we build GAM model in order to get spline approximation of effect. In case of qualitative predictor we build factorMerger object and get optimal factor division on that.</p>
<p>To extract the model, use transition method with <code>type = "base"</code>:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" data-line-number="1"><span class="kw"><a href="../reference/transition.html">transition</a></span>(model_xs, <span class="dt">predictor =</span> <span class="st">"Petal.Length"</span>, <span class="dt">type =</span> <span class="st">"base"</span>)</a></code></pre></div>
<pre><code>## 
## Family: gaussian 
## Link function: identity 
## 
## Formula:
## yhat ~ s(Petal.Length, bs = "cr")
## 
## Estimated degrees of freedom:
## 8.8  total = 9.8 
## 
## GCV score: 0.001355993</code></pre>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" data-line-number="1"><span class="kw"><a href="../reference/transition.html">transition</a></span>(model_xs, <span class="dt">predictor =</span> <span class="st">"Species"</span>, <span class="dt">type =</span> <span class="st">"base"</span>)</a></code></pre></div>
<pre><code>## Family: gaussian Factor Merger.
## 
## Factor levels were merged in the following order:
## 
##      groupA       groupB                     model   pvalVsFull   pvalVsPrevious
## ---  -----------  --------------------  ----------  -----------  ---------------
## 0                                        -251.5247            1                1
## 1    versicolor   virginica              -268.7814            0                0
## 2    setosa       versicolorvirginica    -352.0094            0                0</code></pre>
</div>
<div id="extracting-transition-function" class="section level2">
<h2 class="hasAnchor">
<a href="#extracting-transition-function" class="anchor"></a>Extracting transition function</h2>
<p>The final result of building transition is transformation function, that is used in the final GLM model estimation.</p>
<p>To extract the function just use transition method with <code>type = "function"</code>.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" data-line-number="1">petal_length_xs &lt;-<span class="st"> </span><span class="kw"><a href="../reference/transition.html">transition</a></span>(model_xs, <span class="dt">predictor =</span> <span class="st">"Petal.Length"</span>, <span class="dt">type =</span> <span class="st">"function"</span>)</a>
<a class="sourceLine" id="cb17-2" data-line-number="2">x &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/seq">seq</a></span>(<span class="dv">1</span>, <span class="dv">7</span>, <span class="dt">length.out =</span> <span class="dv">50</span>)</a>
<a class="sourceLine" id="cb17-3" data-line-number="3"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(x, <span class="kw">petal_length_xs</span>(x))</a></code></pre></div>
<p><img src="methods_files/figure-html/unnamed-chunk-7-1.png" width="700"></p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" data-line-number="1">species_xf &lt;-<span class="st"> </span><span class="kw"><a href="../reference/transition.html">transition</a></span>(model_xs, <span class="dt">predictor =</span> <span class="st">"Species"</span>, <span class="dt">type =</span> <span class="st">"function"</span>)</a>
<a class="sourceLine" id="cb18-2" data-line-number="2"><span class="kw">species_xf</span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"setosa"</span>, <span class="st">"versicolor"</span>, <span class="st">"virginica"</span>))</a></code></pre></div>
<pre><code>## [1] setosa              versicolorvirginica versicolorvirginica
## Levels: setosa versicolorvirginica</code></pre>
</div>
</div>
<div id="summary" class="section level1">
<h1 class="hasAnchor">
<a href="#summary" class="anchor"></a>Summary</h1>
<p>Summary method allows you to check the basic model details. See below what possibilities the method to xspliner model offers.</p>
<div id="glm-summary" class="section level2">
<h2 class="hasAnchor">
<a href="#glm-summary" class="anchor"></a>GLM summary</h2>
<p>Standard summary method is just wrapper for <code>summary::glm</code>. In order to use this just type:</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb20-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/summary">summary</a></span>(model_xs)</a></code></pre></div>
<pre><code>## 
## Call:
## stats::glm(formula = Petal.Width ~ Sepal.Length + xs(Petal.Length) + 
##     xf(Species), family = family, data = data)
## 
## Deviance Residuals: 
##      Min        1Q    Median        3Q       Max  
## -0.69789  -0.08748  -0.01917   0.10780   0.50900  
## 
## Coefficients:
##                                Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)                    -2.18088    0.14375 -15.171  &lt; 2e-16 ***
## Sepal.Length                   -0.01554    0.03619  -0.429    0.668    
## xs(Petal.Length)                3.24401    0.22208  14.607  &lt; 2e-16 ***
## xf(Species)versicolorvirginica -0.54145    0.11517  -4.701 5.93e-06 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## (Dispersion parameter for gaussian family taken to be 0.0348956)
## 
##     Null deviance: 86.5699  on 149  degrees of freedom
## Residual deviance:  5.0948  on 146  degrees of freedom
## AIC: -71.682
## 
## Number of Fisher Scoring iterations: 2</code></pre>
</div>
<div id="predictor-based-summary" class="section level2">
<h2 class="hasAnchor">
<a href="#predictor-based-summary" class="anchor"></a>Predictor based summary</h2>
<p>Summary method allows you to check details about transformation of specific variable.</p>
<p>Standard usage <code><a href="https://www.rdocumentation.org/packages/base/topics/summary">summary(xspliner_object, variable_name)</a></code></p>
<p><em>Quantitative variable</em></p>
<p>When predictor is quantitative variable its transition is based on GAM model. For this case summary displays summary of that model.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb22-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/summary">summary</a></span>(model_xs, <span class="st">"Petal.Length"</span>)</a></code></pre></div>
<pre><code>## 
## Family: gaussian 
## Link function: identity 
## 
## Formula:
## yhat ~ s(Petal.Length, bs = "cr")
## 
## Parametric coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 1.211468   0.003497   346.4   &lt;2e-16 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Approximate significance of smooth terms:
##                   edf Ref.df     F p-value    
## s(Petal.Length) 8.796  8.988 692.3  &lt;2e-16 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## R-sq.(adj) =  0.984   Deviance explained = 98.6%
## GCV = 0.001356  Scale est. = 0.0012232  n = 100</code></pre>
<p><em>Qualitative variable</em></p>
<p>In case of qualitative predictor, the method displays data.frame storing information how factors were merged during the transition.</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb24-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/summary">summary</a></span>(model_xs, <span class="st">"Species"</span>)</a></code></pre></div>
<pre><code>##         orig                pred
## 1     setosa              setosa
## 2 versicolor versicolorvirginica
## 3  virginica versicolorvirginica</code></pre>
</div>
<div id="surrogate-vs-black-box-comparison" class="section level2">
<h2 class="hasAnchor">
<a href="#surrogate-vs-black-box-comparison" class="anchor"></a>Surrogate vs Black Box comparison</h2>
<p>Providing <code>model</code> parameter instead of <code>predictor</code>, the summary displays a few statistics that compares original model with surrogate one. All statistics definitions are included in <code>summary.xspline</code> documentation.</p>
<p>Here we show one example for classification model.</p>
<p>For this example we use <code><a href="https://www.rdocumentation.org/packages/ISLR/topics/Default">ISLR::Default</a></code> data and build svm model as black box. The model aims to predict <code>default</code> variable, indicating whether the customer defaulted on their debt.</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb26-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(xspliner)</a>
<a class="sourceLine" id="cb26-2" data-line-number="2"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(e1071)</a>
<a class="sourceLine" id="cb26-3" data-line-number="3"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Random">set.seed</a></span>(<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb26-4" data-line-number="4">data &lt;-<span class="st"> </span>ISLR<span class="op">::</span>Default</a>
<a class="sourceLine" id="cb26-5" data-line-number="5">default.svm &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/e1071/topics/svm">svm</a></span>(default <span class="op">~</span><span class="st"> </span>., <span class="dt">data =</span> data, <span class="dt">probability =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb26-6" data-line-number="6">default.xs &lt;-<span class="st"> </span><span class="kw"><a href="../reference/xspline.html">xspline</a></span>(default <span class="op">~</span><span class="st"> </span>student <span class="op">+</span><span class="st"> </span><span class="kw">xs</span>(balance) <span class="op">+</span><span class="st"> </span><span class="kw">xs</span>(income), <span class="dt">model =</span> default.svm)</a></code></pre></div>
<p>In order to check the summary, we need to specify prediction functions for each model. In this case predictions are probabilities of success:</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb27-1" data-line-number="1">prob_svm &lt;-<span class="st"> </span><span class="cf">function</span>(object, newdata) <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/attr">attr</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/predict">predict</a></span>(object, <span class="dt">newdata =</span> newdata, <span class="dt">probability =</span> <span class="ot">TRUE</span>), <span class="st">"probabilities"</span>)[, <span class="dv">2</span>]</a>
<a class="sourceLine" id="cb27-2" data-line-number="2">prob_xs &lt;-<span class="st"> </span><span class="cf">function</span>(object, newdata) <span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/predict">predict</a></span>(object, <span class="dt">newdata =</span> newdata, <span class="dt">type =</span> <span class="st">"response"</span>)</a></code></pre></div>
<p>Almost each summary statistic compares models basing on some data.</p>
<p>In this case we’re going to compare models on training data providing:</p>
<ul>
<li>
<code>newdata</code> parameter as training data</li>
<li>
<code>model</code> parameter with black box model</li>
<li>
<code>prediction_funs</code> as a list of prediction functions (for surrogate and original model respectively)</li>
</ul>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb28-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/summary">summary</a></span>(default.xs, <span class="dt">model =</span> default.svm, <span class="dt">newdata =</span> data, <span class="dt">prediction_funs =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/list">list</a></span>(prob_xs, prob_svm))</a></code></pre></div>
<pre><code>## Models comparison 
##   1 - Max prediction normed-diff:  0.5268109 
##   R^2:  0.9185403 
##   1 - Max ROC diff:  0.8712113 
##   1 - Mean ROC diff:  0.9506292</code></pre>
<p>Another set of statistics is generated for prediction functions that return response levels.</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb30-1" data-line-number="1">response_svm &lt;-<span class="st"> </span><span class="cf">function</span>(object, newdata) <span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/predict">predict</a></span>(object, <span class="dt">newdata =</span> newdata)</a>
<a class="sourceLine" id="cb30-2" data-line-number="2">response_xs &lt;-<span class="st"> </span><span class="cf">function</span>(object, newdata) {</a>
<a class="sourceLine" id="cb30-3" data-line-number="3">  y_levels &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/levels">levels</a></span>(newdata[[<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/environment">environment</a></span>(object)<span class="op">$</span>response]])</a>
<a class="sourceLine" id="cb30-4" data-line-number="4">  <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/factor">factor</a></span>(y_levels[(<span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/predict.glm">predict.glm</a></span>(object, <span class="dt">newdata =</span> newdata, <span class="dt">type =</span> <span class="st">"link"</span>) <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>) <span class="op">+</span><span class="st"> </span><span class="dv">1</span>], <span class="dt">levels =</span> y_levels)</a>
<a class="sourceLine" id="cb30-5" data-line-number="5">}</a></code></pre></div>
<p>And similarly to previous example:</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb31-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/summary">summary</a></span>(default.xs, <span class="dt">model =</span> default.svm, <span class="dt">newdata =</span> data, <span class="dt">prediction_funs =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/list">list</a></span>(response_xs, response_svm))</a></code></pre></div>
<pre><code>## Models comparison 
##   Mean predictions similarity:  0.9966 
##   ACC Black Box:  0.9719 
##   ACC Surrogate:  0.9729</code></pre>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#predict">Predict</a></li>
      <li>
<a href="#print">Print</a><ul class="nav nav-pills nav-stacked">
<li><a href="#predictor-based-print">Predictor based print</a></li>
      </ul>
</li>
      <li><a href="#plot">Plot</a></li>
      <li>
<a href="#transition">Transition</a><ul class="nav nav-pills nav-stacked">
<li><a href="#extracting-effect">Extracting effect</a></li>
      <li><a href="#extracting-transition-model">Extracting transition model</a></li>
      <li><a href="#extracting-transition-function">Extracting transition function</a></li>
      </ul>
</li>
      <li>
<a href="#summary">Summary</a><ul class="nav nav-pills nav-stacked">
<li><a href="#glm-summary">GLM summary</a></li>
      <li><a href="#predictor-based-summary">Predictor based summary</a></li>
      <li><a href="#surrogate-vs-black-box-comparison">Surrogate vs Black Box comparison</a></li>
      </ul>
</li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Krystian Igras, Przemyslaw Biecek.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  </body>
</html>

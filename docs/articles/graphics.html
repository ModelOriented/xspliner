<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Graphics • xspliner</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="../dalexverse.css" rel="stylesheet">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../dalexverse-2.css" rel="stylesheet">
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Graphics">
<meta property="og:description" content="">
<meta property="og:image" content="/logo.png">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- google analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-5650686-14"></script><script>
 window.dataLayer = window.dataLayer || [];
 function gtag(){dataLayer.push(arguments);}
 gtag('js', new Date());

 gtag('config', 'UA-5650686-14');
</script>
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>

      <div class="navbar-brand-container">
        <a class="navbar-brand" href="../index.html">xspliner</a>
        <div class="info">
          <span class="partof">part of the <a href="https://github.com/ModelOriented/DrWhy">DrWhy.AI</a>
           developed by the <a href="https://mi2.mini.pw.edu.pl/">MI^2 DataLab</a> </span>
          <span class="version version-default">0.0.4</span>
        </div>
      </div>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav navbar-right">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/xspliner.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/discrete.html">Classification and discrete predictors</a>
    </li>
    <li>
      <a href="../articles/graphics.html">Graphics</a>
    </li>
    <li>
      <a href="../articles/automation.html">Automate your work</a>
    </li>
    <li>
      <a href="../articles/methods.html">Methods and xspliner environment</a>
    </li>
    <li>
      <a href="../articles/extras.html">Extra information about the package</a>
    </li>
    <li>
      <a href="../articles/cases.html">Use cases</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
        
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Graphics</h1>
                        <h4 class="author">Krystian Igras</h4>
            
            <h4 class="date">2019-10-05</h4>
      
      
      <div class="hidden name"><code>graphics.Rmd</code></div>

    </div>

    
    
<p>This document presents possible options of how the final model can be described through plots and graphics</p>
<div id="single-variable-results" class="section level1">
<h1 class="hasAnchor">
<a href="#single-variable-results" class="anchor"></a>Single variable results</h1>
<p>As you actually saw in the previous sections, the model transformation can be presented on simple graphics. In continuous predictor case, the transformation is plotted as estimated spline - in case of discrete predictor, factorMerger plot is used.</p>
<p>For quantitative predictors some additional options are offered. Let’s check them on the below examples.</p>
<p>Let’s use already known Boston Housing Data, and a random forest model.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(pdp)</a>
<a class="sourceLine" id="cb1-2" data-line-number="2"><span class="kw"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(boston)</a>
<a class="sourceLine" id="cb1-3" data-line-number="3"><span class="kw"><a href="https://rdrr.io/r/utils/str.html">str</a></span>(boston)</a></code></pre></div>
<pre><code>## 'data.frame':    506 obs. of  16 variables:
##  $ lon    : num  -71 -71 -70.9 -70.9 -70.9 ...
##  $ lat    : num  42.3 42.3 42.3 42.3 42.3 ...
##  $ cmedv  : num  24 21.6 34.7 33.4 36.2 28.7 22.9 22.1 16.5 18.9 ...
##  $ crim   : num  0.00632 0.02731 0.02729 0.03237 0.06905 ...
##  $ zn     : num  18 0 0 0 0 0 12.5 12.5 12.5 12.5 ...
##  $ indus  : num  2.31 7.07 7.07 2.18 2.18 2.18 7.87 7.87 7.87 7.87 ...
##  $ chas   : Factor w/ 2 levels "0","1": 1 1 1 1 1 1 1 1 1 1 ...
##  $ nox    : num  0.538 0.469 0.469 0.458 0.458 0.458 0.524 0.524 0.524 0.524 ...
##  $ rm     : num  6.58 6.42 7.18 7 7.15 ...
##  $ age    : num  65.2 78.9 61.1 45.8 54.2 58.7 66.6 96.1 100 85.9 ...
##  $ dis    : num  4.09 4.97 4.97 6.06 6.06 ...
##  $ rad    : int  1 2 2 3 3 3 5 5 5 5 ...
##  $ tax    : int  296 242 242 222 222 222 311 311 311 311 ...
##  $ ptratio: num  15.3 17.8 17.8 18.7 18.7 18.7 15.2 15.2 15.2 15.2 ...
##  $ b      : num  397 397 393 395 397 ...
##  $ lstat  : num  4.98 9.14 4.03 2.94 5.33 ...</code></pre>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(boston)</a>
<a class="sourceLine" id="cb3-2" data-line-number="2"><span class="kw"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="dv">123</span>)</a>
<a class="sourceLine" id="cb3-3" data-line-number="3"></a>
<a class="sourceLine" id="cb3-4" data-line-number="4"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(randomForest)</a>
<a class="sourceLine" id="cb3-5" data-line-number="5">boston.rf &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/pkg/randomForest/man/randomForest.html">randomForest</a></span>(cmedv <span class="op">~</span><span class="st"> </span>lstat <span class="op">+</span><span class="st"> </span>ptratio <span class="op">+</span><span class="st"> </span>age, <span class="dt">data =</span> boston)</a></code></pre></div>
<p>Also let’s build xspliner model with lstat and ptratio transformation.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(xspliner)</a>
<a class="sourceLine" id="cb4-2" data-line-number="2">model_xs &lt;-<span class="st"> </span><span class="kw"><a href="../reference/xspline.html">xspline</a></span>(cmedv <span class="op">~</span><span class="st"> </span><span class="kw">xs</span>(lstat) <span class="op">+</span><span class="st"> </span><span class="kw">xs</span>(ptratio) <span class="op">+</span><span class="st"> </span>age, <span class="dt">model =</span> boston.rf)</a></code></pre></div>
<p>In order to plot specified predictor transformation you can use general plot method:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(model_xs, <span class="st">"lstat"</span>)</a></code></pre></div>
<p>or use explicit function</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1"><span class="kw"><a href="../reference/plot_variable_transition.html">plot_variable_transition</a></span>(model_xs, <span class="st">"lstat"</span>)</a></code></pre></div>
<p><img src="graphics_files/figure-html/unnamed-chunk-4-1.png" width="700"></p>
<p>In general plot method provides all functionality that xspliner provides for graphics. For transition plotting you may use explicit <code>plot_variable_transition</code> or general <code>plot</code> with providing corresponding parameters.</p>
<p>You can also add some additional information for the plot.</p>
<p><strong>Plotting training data</strong></p>
<p>Just add two parameters: <code>data = &lt;training data&gt;</code> and flag <code>plot_data = TRUE</code>.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1"><span class="kw"><a href="../reference/plot_variable_transition.html">plot_variable_transition</a></span>(model_xs, <span class="st">"lstat"</span>, <span class="dt">data =</span> boston, <span class="dt">plot_data =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<p><img src="graphics_files/figure-html/unnamed-chunk-5-1.png" width="700"></p>
<p><strong>Plotting approximation derivative</strong></p>
<p>The derivative is plotted on scale of the second axis. To display it just add: <code>plot_deriv = TRUE</code>.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1"><span class="kw"><a href="../reference/plot_variable_transition.html">plot_variable_transition</a></span>(model_xs, <span class="st">"lstat"</span>, <span class="dt">plot_deriv =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<p><img src="graphics_files/figure-html/unnamed-chunk-6-1.png" width="700"></p>
<p>You can also specify if the model effect or transition should be displayed. Parameters responsible for that are <code>plot_response</code> and <code>plot_approx</code> respectively.</p>
<p>For example below we display just the approximation and derivative for ptratio variable:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1"><span class="kw"><a href="../reference/plot_variable_transition.html">plot_variable_transition</a></span>(model_xs, <span class="st">"ptratio"</span>, <span class="dt">plot_response =</span> <span class="ot">FALSE</span>, <span class="dt">plot_deriv =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<p><img src="graphics_files/figure-html/unnamed-chunk-7-1.png" width="700"></p>
</div>
<div id="models-comparison" class="section level1">
<h1 class="hasAnchor">
<a href="#models-comparison" class="anchor"></a>Models comparison</h1>
<p>As we may want to compare the final GLM model with its parent black box, xspliner provides one simple tool.</p>
<p>For comparison just add use <code>plot_model_comparison</code> or use general <code>plot</code> method with corresponding parameters:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1"><span class="kw"><a href="../reference/plot_model_comparison.html">plot_model_comparison</a></span>(model_xs, <span class="dt">model =</span> boston.rf, <span class="dt">data =</span> boston)</a></code></pre></div>
<p>or</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(model_xs, <span class="dt">model =</span> boston.rf, <span class="dt">data =</span> boston)</a></code></pre></div>
<p><img src="graphics_files/figure-html/unnamed-chunk-9-1.png" width="700"></p>
<p>The resulting graphics compares predicted values for both GLM and black box model.</p>
<p>For predicting values standard predict method is used: <code>function(object, newdata) predict(object, newdata)</code>. So for regression models the results are on the same scale.</p>
<p>The notable difference occurs in the classification models. GLM models by default return “link” function values, so for classification it can be any real number. Contrary to that, randomForest function returns predicted levels.</p>
<p>To avoid the problem, <code>predictor_funs</code> parameter was added. This is the list of prediction functions for each model (in order: black box, xspliner). Let’s see it on SVM example:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" data-line-number="1">iris_data &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/droplevels.html">droplevels</a></span>(iris[iris<span class="op">$</span>Species <span class="op">!=</span><span class="st"> "setosa"</span>, ])</a>
<a class="sourceLine" id="cb12-2" data-line-number="2"></a>
<a class="sourceLine" id="cb12-3" data-line-number="3"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(e1071) </a></code></pre></div>
<pre><code>## Warning: package 'e1071' was built under R version 3.5.2</code></pre>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(xspliner)</a>
<a class="sourceLine" id="cb14-2" data-line-number="2">model_svm &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/pkg/e1071/man/svm.html">svm</a></span>(Species <span class="op">~</span><span class="st">  </span>Sepal.Length <span class="op">+</span><span class="st"> </span>Sepal.Width <span class="op">+</span><span class="st"> </span>Petal.Length <span class="op">+</span><span class="st"> </span>Petal.Width, </a>
<a class="sourceLine" id="cb14-3" data-line-number="3">                 <span class="dt">data =</span> iris_data, <span class="dt">probability =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb14-4" data-line-number="4"></a>
<a class="sourceLine" id="cb14-5" data-line-number="5">model_xs &lt;-<span class="st"> </span><span class="kw"><a href="../reference/xspline.html">xspline</a></span>(Species <span class="op">~</span><span class="st">  </span><span class="kw">xs</span>(Sepal.Length) <span class="op">+</span><span class="st"> </span><span class="kw">xs</span>(Sepal.Width) <span class="op">+</span><span class="st"> </span><span class="kw">xs</span>(Petal.Length) <span class="op">+</span><span class="st"> </span><span class="kw">xs</span>(Petal.Width),</a>
<a class="sourceLine" id="cb14-6" data-line-number="6">                    <span class="dt">model =</span> model_svm)</a></code></pre></div>
<p>Now we specify predict functions to return probability of virginica response.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" data-line-number="1">prob_svm &lt;-<span class="st"> </span><span class="cf">function</span>(object, newdata) <span class="kw"><a href="https://rdrr.io/r/base/attr.html">attr</a></span>(<span class="kw"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span>(object, <span class="dt">newdata =</span> newdata, <span class="dt">probability =</span> <span class="ot">TRUE</span>), <span class="st">"probabilities"</span>)[, <span class="dv">2</span>]</a>
<a class="sourceLine" id="cb15-2" data-line-number="2">prob_xs &lt;-<span class="st"> </span><span class="cf">function</span>(object, newdata) <span class="kw"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span>(object, <span class="dt">newdata =</span> newdata, <span class="dt">type =</span> <span class="st">"response"</span>)</a></code></pre></div>
<p>And plot the result</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" data-line-number="1"><span class="kw"><a href="../reference/plot_model_comparison.html">plot_model_comparison</a></span>(model_xs, <span class="dt">model =</span> model_svm, <span class="dt">data =</span> iris_data,</a>
<a class="sourceLine" id="cb16-2" data-line-number="2">     <span class="dt">prediction_funs =</span> <span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(prob_xs, prob_svm)</a>
<a class="sourceLine" id="cb16-3" data-line-number="3">)  </a></code></pre></div>
<p><img src="graphics_files/figure-html/unnamed-chunk-12-1.png" width="700"></p>
<p>It is also possible to sort the values of heatmap according to chosen model:</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" data-line-number="1"><span class="kw"><a href="../reference/plot_model_comparison.html">plot_model_comparison</a></span>(model_xs, <span class="dt">model =</span> model_svm, <span class="dt">data =</span> iris_data,</a>
<a class="sourceLine" id="cb17-2" data-line-number="2">     <span class="dt">prediction_funs =</span> <span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(prob_xs, prob_svm),</a>
<a class="sourceLine" id="cb17-3" data-line-number="3">     <span class="dt">sort_by =</span> <span class="st">"svm"</span></a>
<a class="sourceLine" id="cb17-4" data-line-number="4">)  </a></code></pre></div>
<p><img src="graphics_files/figure-html/unnamed-chunk-13-1.png" width="700"></p>
<p>In case of class predictions, let’s create class prediction function first:</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" data-line-number="1">class_svm &lt;-<span class="st"> </span><span class="cf">function</span>(object, newdata) <span class="kw"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span>(object, <span class="dt">newdata =</span> newdata)</a>
<a class="sourceLine" id="cb18-2" data-line-number="2">response_levels &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/levels.html">levels</a></span>(iris_data<span class="op">$</span>Species)</a>
<a class="sourceLine" id="cb18-3" data-line-number="3">class_xs &lt;-<span class="st"> </span><span class="cf">function</span>(object, newdata) {</a>
<a class="sourceLine" id="cb18-4" data-line-number="4">  probs &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span>(object, <span class="dt">newdata =</span> newdata, <span class="dt">type =</span> <span class="st">"response"</span>)</a>
<a class="sourceLine" id="cb18-5" data-line-number="5">  <span class="kw"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span>(probs <span class="op">&gt;</span><span class="st"> </span><span class="fl">0.5</span>, response_levels[<span class="dv">2</span>], response_levels[<span class="dv">1</span>]), <span class="dt">levels =</span> response_levels)</a>
<a class="sourceLine" id="cb18-6" data-line-number="6">}</a></code></pre></div>
<p>And plot the result:</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" data-line-number="1"><span class="kw"><a href="../reference/plot_model_comparison.html">plot_model_comparison</a></span>(model_xs, <span class="dt">model =</span> model_svm, <span class="dt">data =</span> iris_data,</a>
<a class="sourceLine" id="cb19-2" data-line-number="2">     <span class="dt">prediction_funs =</span> <span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(class_xs, class_svm)</a>
<a class="sourceLine" id="cb19-3" data-line-number="3">)  </a></code></pre></div>
<p><img src="graphics_files/figure-html/unnamed-chunk-15-1.png" width="700"></p>
<p>Sorting values according to specified model is also possible:</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb20-1" data-line-number="1"><span class="kw"><a href="../reference/plot_model_comparison.html">plot_model_comparison</a></span>(model_xs, <span class="dt">model =</span> model_svm, <span class="dt">data =</span> iris_data,</a>
<a class="sourceLine" id="cb20-2" data-line-number="2">     <span class="dt">prediction_funs =</span> <span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(class_xs, class_svm),</a>
<a class="sourceLine" id="cb20-3" data-line-number="3">     <span class="dt">sort_by =</span> <span class="st">"svm"</span></a>
<a class="sourceLine" id="cb20-4" data-line-number="4">)  </a></code></pre></div>
<p><img src="graphics_files/figure-html/unnamed-chunk-16-1.png" width="700"></p>
<div id="comparing-with-another-models" class="section level2">
<h2 class="hasAnchor">
<a href="#comparing-with-another-models" class="anchor"></a>Comparing with another models</h2>
<p>Following above approach it’s easy to generate similar graphics for higher amount of models.</p>
<p>Just include additional models inside <code>compare_with</code> parameter (named list), and add corresponding predict functions to them to <code>predictor_funs</code> parameter (if omitted, the default one is used).</p>
<p>See below example on airquality data</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb21-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(mgcv)</a></code></pre></div>
<pre><code>## Warning: package 'mgcv' was built under R version 3.5.2</code></pre>
<pre><code>## Warning: package 'nlme' was built under R version 3.5.2</code></pre>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb24-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(airquality)</a>
<a class="sourceLine" id="cb24-2" data-line-number="2">ozone &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/subset.html">subset</a></span>(<span class="kw"><a href="https://rdrr.io/r/stats/na.fail.html">na.omit</a></span>(airquality),</a>
<a class="sourceLine" id="cb24-3" data-line-number="3">                <span class="dt">select =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Ozone"</span>, <span class="st">"Solar.R"</span>, <span class="st">"Wind"</span>, <span class="st">"Temp"</span>))</a>
<a class="sourceLine" id="cb24-4" data-line-number="4"><span class="kw"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="dv">123</span>)</a>
<a class="sourceLine" id="cb24-5" data-line-number="5"></a>
<a class="sourceLine" id="cb24-6" data-line-number="6">model_rf &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/pkg/randomForest/man/randomForest.html">randomForest</a></span>(Ozone <span class="op">~</span><span class="st"> </span>., <span class="dt">data =</span> ozone)</a>
<a class="sourceLine" id="cb24-7" data-line-number="7">model_xs &lt;-<span class="st"> </span><span class="kw"><a href="../reference/xspline.html">xspline</a></span>(Ozone <span class="op">~</span><span class="st"> </span><span class="kw">xs</span>(Solar.R) <span class="op">+</span><span class="st"> </span><span class="kw">xs</span>(Wind) <span class="op">+</span><span class="st"> </span><span class="kw">xs</span>(Temp), model_rf, <span class="dt">data =</span> ozone)</a>
<a class="sourceLine" id="cb24-8" data-line-number="8">model_glm &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/stats/glm.html">glm</a></span>(Ozone <span class="op">~</span><span class="st"> </span>., <span class="dt">data =</span> ozone)</a>
<a class="sourceLine" id="cb24-9" data-line-number="9">model_gam &lt;-<span class="st"> </span>mgcv<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/mgcv/man/gam.html">gam</a></span>(Ozone <span class="op">~</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/pkg/mgcv/man/s.html">s</a></span>(Solar.R) <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/pkg/mgcv/man/s.html">s</a></span>(Wind) <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/pkg/mgcv/man/s.html">s</a></span>(Temp), <span class="dt">data =</span> ozone)</a>
<a class="sourceLine" id="cb24-10" data-line-number="10"></a>
<a class="sourceLine" id="cb24-11" data-line-number="11"><span class="kw"><a href="../reference/plot_model_comparison.html">plot_model_comparison</a></span>(model_xs, </a>
<a class="sourceLine" id="cb24-12" data-line-number="12">     <span class="dt">model =</span> model_rf, </a>
<a class="sourceLine" id="cb24-13" data-line-number="13">     <span class="dt">data =</span> ozone, </a>
<a class="sourceLine" id="cb24-14" data-line-number="14">     <span class="dt">compare_with =</span> <span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="dt">glm =</span> model_glm, <span class="dt">gam =</span> model_gam),</a>
<a class="sourceLine" id="cb24-15" data-line-number="15">     <span class="dt">sort_by =</span> <span class="st">"xspliner"</span>)</a></code></pre></div>
<p><img src="graphics_files/figure-html/unnamed-chunk-17-1.png" width="700"></p>
</div>
</div>
<div id="plotting-more-transitions-at-once" class="section level1">
<h1 class="hasAnchor">
<a href="#plotting-more-transitions-at-once" class="anchor"></a>Plotting more transitions at once</h1>
<p>If you want to display many transitions on one plot just pass xspliner model to plot:</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb25-1" data-line-number="1"><span class="kw"><a href="../reference/plot_variable_transition.html">plot_variable_transition</a></span>(model_xs)</a></code></pre></div>
<p><img src="graphics_files/figure-html/unnamed-chunk-18-1.png" width="912"></p>
<p>For models trained on top of many predictors, there will be displayed plots for 6 first transformed variables. To change that value just set <code>n_plots</code> variable:</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb26-1" data-line-number="1"><span class="kw"><a href="../reference/plot_variable_transition.html">plot_variable_transition</a></span>(model_xs, <span class="dt">n_plots =</span> <span class="dv">2</span>)</a></code></pre></div>
<p><img src="graphics_files/figure-html/unnamed-chunk-19-1.png" width="912"></p>
<p>You can select interesting variables to plot just passing predictor names in vector:</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb27-1" data-line-number="1"><span class="kw"><a href="../reference/plot_variable_transition.html">plot_variable_transition</a></span>(model_xs, <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Wind"</span>, <span class="st">"Temp"</span>))</a></code></pre></div>
<p><img src="graphics_files/figure-html/unnamed-chunk-20-1.png" width="912"></p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">

        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#single-variable-results">Single variable results</a></li>
      <li>
<a href="#models-comparison">Models comparison</a><ul class="nav nav-pills nav-stacked">
<li><a href="#comparing-with-another-models">Comparing with another models</a></li>
      </ul>
</li>
      <li><a href="#plotting-more-transitions-at-once">Plotting more transitions at once</a></li>
      </ul>
</div>
      </div>

</div>



      <footer><div class="author">
  <p>
    Developed by Krystian Igras, Przemyslaw Biecek.
    Site built by <a href="https://pkgdown.r-lib.org">pkgdown</a>.
  </p>
</div>

      </footer>
</div>

  


  </body>
</html>
